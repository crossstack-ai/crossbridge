# ============================================================================
# NOTICE: Unified Configuration Available (Recommended)
# ============================================================================
# This file serves as a TEMPLATE and FALLBACK only.
#
# RECOMMENDED APPROACH: Define rules in crossbridge.yml instead:
#
#   crossbridge:
#     intelligence:
#       rules:
#         pytest:
#           - id: PYT_001
#             description: Fixture failures
#             match_any:
#               - fixture
#               - "@pytest.fixture"
#             failure_type: AUTOMATION_DEFECT
#             confidence: 0.85
#             priority: 15
#
# This file is used as fallback ONLY if rules are not found in crossbridge.yml
# See: UNIFIED_CONFIGURATION_GUIDE.md for detailed documentation
# ============================================================================

# Pytest-Specific Classification Rules
# Optimized for pytest and Python unit/integration tests

name: pytest
version: 1.0.0
description: Classification rules for pytest tests

rules:
  # ============================================================================
  # AUTOMATION DEFECTS (Pytest-Specific)
  # ============================================================================
  
  - id: PYT_001
    description: Fixture failures
    match_any:
      - fixture
      - "@pytest.fixture"
      - setup failed
      - teardown failed
    failure_type: AUTOMATION_DEFECT
    confidence: 0.85
    priority: 15
  
  - id: PYT_002
    description: Parametrization issues
    match_any:
      - parametrize
      - "@pytest.mark.parametrize"
      - parameter
    failure_type: AUTOMATION_DEFECT
    confidence: 0.8
    priority: 20
  
  - id: PYT_003
    description: Import or module errors
    match_any:
      - ImportError
      - ModuleNotFoundError
      - cannot import name
      - No module named
    failure_type: AUTOMATION_DEFECT
    confidence: 0.9
    priority: 10
  
  - id: PYT_004
    description: Mock/patch issues
    match_any:
      - mock
      - patch
      - unittest.mock
      - MagicMock
    requires_all:
      - error
    failure_type: AUTOMATION_DEFECT
    confidence: 0.85
    priority: 18
  
  # ============================================================================
  # ENVIRONMENT ISSUES
  # ============================================================================
  
  - id: PYT_ENV_001
    description: Database connection failures
    match_any:
      - OperationalError
      - Connection refused
      - could not connect
      - database
    failure_type: ENVIRONMENT_ISSUE
    confidence: 0.85
    priority: 12
  
  - id: PYT_ENV_002
    description: API/Network errors
    match_any:
      - ConnectionError
      - HTTPError
      - Timeout
      - ReadTimeout
      - ConnectTimeout
    failure_type: ENVIRONMENT_ISSUE
    confidence: 0.8
    priority: 15
    excludes:
      - assertion
      - expected
  
  - id: PYT_ENV_003
    description: File system issues
    match_any:
      - FileNotFoundError
      - PermissionError
      - IOError
      - OSError
    failure_type: ENVIRONMENT_ISSUE
    confidence: 0.85
    priority: 18
  
  - id: PYT_ENV_004
    description: Resource exhaustion
    match_any:
      - MemoryError
      - Too many open files
      - Resource temporarily unavailable
    failure_type: ENVIRONMENT_ISSUE
    confidence: 0.9
    priority: 10
  
  # ============================================================================
  # PRODUCT DEFECTS
  # ============================================================================
  
  - id: PYT_PROD_001
    description: Assertion failures (product behavior)
    match_any:
      - AssertionError
      - assert
    failure_type: PRODUCT_DEFECT
    confidence: 0.75
    priority: 25
    excludes:
      - fixture
      - mock
      - test setup
  
  - id: PYT_PROD_002
    description: Application exceptions
    match_any:
      - ValueError
      - TypeError
      - KeyError
      - AttributeError
    failure_type: PRODUCT_DEFECT
    confidence: 0.7
    priority: 30
    excludes:
      - test
      - fixture
  
  - id: PYT_PROD_003
    description: Logic errors
    match_any:
      - IndexError
      - ZeroDivisionError
      - UnboundLocalError
    failure_type: PRODUCT_DEFECT
    confidence: 0.85
    priority: 20
  
  - id: PYT_PROD_004
    description: Business logic failures
    match_any:
      - ValidationError
      - IntegrityError
      - BusinessRuleException
    failure_type: PRODUCT_DEFECT
    confidence: 0.9
    priority: 15
  
  # ============================================================================
  # CONFIGURATION ISSUES
  # ============================================================================
  
  - id: PYT_CONFIG_001
    description: Missing environment variables
    match_any:
      - KeyError
      - environment variable
      - ENV
      - config
    requires_all:
      - not found
    failure_type: CONFIGURATION_ISSUE
    confidence: 0.85
    priority: 20
  
  - id: PYT_CONFIG_002
    description: Configuration file issues
    match_any:
      - config
      - settings
      - ConfigParser
    requires_all:
      - error
    failure_type: CONFIGURATION_ISSUE
    confidence: 0.8
    priority: 22
