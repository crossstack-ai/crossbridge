# ============================================================================
# CrossBridge Unified Configuration File
# ============================================================================
# Single source of truth for all CrossBridge configuration
# Supports environment variable substitution: ${VAR_NAME:-default_value}
# ============================================================================

crossbridge:
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # CORE SETTINGS
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  
  # Operational mode: 'migration' or 'observer'
  # - migration: Active test discovery and framework transformation
  # - observer: Continuous intelligence and monitoring (default)
  mode: observer
  
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # APPLICATION TRACKING
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # Used for version-based coverage analysis and test tracking
  
  application:
    # Product/Application name (e.g., "PaymentAPI", "WebPortal")
    # Override with: PRODUCT_NAME or CROSSBRIDGE_PRODUCT_NAME
    product_name: ${PRODUCT_NAME:-CrossBridgeApp}
    
    # Application version being tested (e.g., "2.1.0", "v3.0.0-beta")
    # Override with: APP_VERSION or CROSSBRIDGE_APP_VERSION
    # CI/CD Tip: export APP_VERSION=$(git describe --tags)
    application_version: ${APP_VERSION:-v1.0.0}
    
    # Environment name (e.g., "dev", "staging", "production")
    # Override with: ENVIRONMENT or CROSSBRIDGE_ENVIRONMENT
    environment: ${ENVIRONMENT:-test}
  
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # DATABASE CONFIGURATION
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # PostgreSQL database for test events, coverage, and intelligence
  
  database:
    enabled: true
    
    # Database connection settings
    # Override with CROSSBRIDGE_DB_* environment variables
    host: ${CROSSBRIDGE_DB_HOST:-10.55.12.99}
    port: ${CROSSBRIDGE_DB_PORT:-5432}
    database: ${CROSSBRIDGE_DB_NAME:-udp-native-webservices-automation}
    user: ${CROSSBRIDGE_DB_USER:-postgres}
    password: ${CROSSBRIDGE_DB_PASSWORD:-admin}
    
    # Connection pool settings (advanced)
    # pool_size: 10
    # max_overflow: 20
    # pool_timeout: 30
  
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # SIDECAR OBSERVER HOOKS
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # Automatic hook integration during test migration
  
  sidecar_hooks:
    # Enable/disable sidecar observer hooks
    enabled: true
    
    # Automatically integrate hooks during migration
    # When true: hooks are configured automatically in migrated tests
    # When false: manual setup required
    auto_integrate: true
  
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # TEST TRANSLATION/MIGRATION
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # Settings for framework-to-framework test transformation
  
  translation:
    # Translation mode
    # - assistive: Human reviews each translation (default, safest)
    # - automated: Automatic with confidence checks (faster)
    # - batch: Bulk translation for large codebases (fastest)
    mode: assistive
    
    # AI-powered translation enhancement
    use_ai: false              # Enable AI refinement (requires credits)
    max_credits: 100           # Maximum AI credits to spend per session
    confidence_threshold: 0.7  # Minimum confidence to auto-apply (0.0-1.0)
    
    # Code validation
    validation_level: strict   # strict, lenient, skip
    preserve_comments: true    # Keep original comments in translated code
    inject_todos: true         # Add TODO comments for manual review items
    
    # Performance tuning
    max_workers: 10            # Parallel translation threads (1-20)
    commit_batch_size: 10      # Files per batch commit (5-20)
  
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # AI / LLM CONFIGURATION
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # AI provider settings for enhanced translation and analysis
  
  ai:
    # Enable AI features
    enabled: false
    
    # Provider: 'openai', 'anthropic', or 'custom'
    provider: openai
    
    # API credentials (NEVER commit real keys to git!)
    # Use environment variable: export OPENAI_API_KEY=sk-...
    # Use environment variable: export ANTHROPIC_API_KEY=sk-ant-...
    api_key: ${OPENAI_API_KEY}
    
    # Custom endpoint (for enterprise/on-prem deployments)
    endpoint: null
    
    # Model selection
    # OpenAI: gpt-3.5-turbo (fast, cheap), gpt-4 (better quality)
    # Anthropic: claude-3-sonnet, claude-3-opus
    model: gpt-3.5-turbo
    
    # Data residency region (for compliance)
    region: US
    
    # Model parameters
    temperature: 0.7           # Creativity (0.0-1.0, lower = more deterministic)
    max_tokens: 2048           # Max response length
    timeout: 60                # Request timeout in seconds
  
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # FLAKY TEST DETECTION
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # Machine learning-based flaky test detection
  
  flaky_detection:
    enabled: true
    
    # Isolation Forest parameters
    n_estimators: 200          # Number of trees in forest
    contamination: 0.1         # Expected ratio of flaky tests (10%)
    random_state: 42           # For reproducible results
    
    # Confidence thresholds
    min_executions_reliable: 15    # Minimum runs for reliable detection
    min_executions_confident: 30   # Runs for full confidence
    min_confidence_threshold: 0.5  # Minimum confidence to classify (0.0-1.0)
    
    # Feature engineering
    execution_window_size: 50  # Number of recent runs to analyze
    recent_window_size: 10     # For temporal pattern detection
    
    # Model management
    auto_retrain: true         # Automatically retrain model
    retrain_threshold: 100     # Retrain after N new tests
    model_version: "1.0.0"     # Model version tracking
  
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # OBSERVER MODE
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # Continuous intelligence and monitoring features
  
  observer:
    # Automatically detect new test files/cases
    auto_detect_new_tests: true
    
    # Update coverage graph continuously
    update_coverage_graph: true
    
    # Detect test drift and behavior changes
    detect_drift: true
    
    # Flaky test failure rate threshold (0.0-1.0)
    # Tests with failure rate above this are flagged
    flaky_threshold: 0.15      # 15% failure rate
  
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # INTELLIGENCE FEATURES
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # AI-powered analysis and recommendations
  
  intelligence:
    # Enable AI-powered intelligence
    ai_enabled: true
    
    # Missing coverage detection
    # Identifies code areas without test coverage
    detect_coverage_gaps: true
    
    # Redundant test detection
    # Finds tests with overlapping coverage
    detect_redundant_tests: true
    
    # Risk-based execution recommendations
    # Suggests which tests to run based on code changes
    risk_based_recommendations: true
  
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # FRAMEWORK-SPECIFIC SETTINGS
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # Configuration for each supported test framework
  # Multi-Framework Support: 12 frameworks across 5 languages
  
  frameworks:
    
    # â”€â”€â”€ pytest (Python Unit/Integration) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    pytest:
      enabled: true
      
      # Automatic instrumentation
      auto_instrument_api_calls: true     # Track API/HTTP calls
      auto_instrument_ui_interactions: false  # Track UI interactions
      
      # Network monitoring
      capture_network_traffic: true       # Capture request/response data
      
      # Tracking options
      track_keywords: true                # Track pytest fixtures/markers
      track_api_calls: true               # Track API endpoint coverage
    
    
    # â”€â”€â”€ JUnit (Java Unit Testing) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    junit:
      enabled: true
      
      # Automatic instrumentation
      auto_instrument_api_calls: true     # Track API calls
      auto_instrument_ui_interactions: false  # Track UI interactions
      
      # Tracking options
      track_keywords: true                # Track @Test annotations
      track_api_calls: true               # Track API endpoint coverage
    
    
    # â”€â”€â”€ TestNG (Java Enterprise Testing) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    testng:
      enabled: true
      
      # Automatic instrumentation
      auto_instrument_api_calls: true     # Track API calls
      auto_instrument_ui_interactions: false  # Track UI interactions
      
      # Tracking options
      track_keywords: true                # Track @Test annotations
      track_api_calls: true               # Track API endpoint coverage
      track_groups: true                  # Track test groups
    
    
    # â”€â”€â”€ NUnit (C# Unit Testing) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    nunit:
      enabled: true
      
      # Automatic instrumentation
      auto_instrument_api_calls: true     # Track API calls
      auto_instrument_ui_interactions: false  # Track UI interactions
      
      # Tracking options
      track_keywords: true                # Track [Test] attributes
      track_api_calls: true               # Track API endpoint coverage
    
    
    # â”€â”€â”€ SpecFlow (C# BDD) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    specflow:
      enabled: true
      
      # Automatic instrumentation
      auto_instrument_api_calls: true     # Track API calls in steps
      auto_instrument_ui_interactions: true  # Track UI interactions in steps
      
      # Tracking options
      track_keywords: true                # Track Gherkin keywords
      track_api_calls: true               # Track API endpoint coverage
      parse_gherkin: true                 # Parse .feature files
    
    
    # â”€â”€â”€ Playwright (JavaScript/TypeScript E2E) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    playwright:
      enabled: true
      
      # Automatic instrumentation
      auto_instrument_api_calls: true     # Track API calls
      auto_instrument_ui_interactions: true  # Track page interactions
      
      # Network monitoring
      capture_network_traffic: true       # Capture network activity
      
      # Tracking options
      track_keywords: true                # Track test annotations
      track_api_calls: true               # Track route handlers
    
    
    # â”€â”€â”€ Robot Framework (Keyword-Driven) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    robot:
      enabled: true
      
      # Automatic instrumentation
      auto_instrument_api_calls: true     # Track RequestsLibrary calls
      auto_instrument_ui_interactions: true  # Track SeleniumLibrary actions
      
      # Network monitoring
      capture_network_traffic: false      # Not supported by default
      
      # Tracking options
      track_keywords: true                # Track custom keywords
      track_api_calls: true               # Track API test cases
    
    
    # â”€â”€â”€ RestAssured (Java REST API Testing) ðŸ†• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    restassured:
      enabled: true
      
      # Automatic instrumentation
      auto_instrument_api_calls: true     # Track REST API calls
      
      # Network monitoring
      capture_network_traffic: true       # Capture request/response data
      
      # Tracking options
      track_keywords: true                # Track @Test annotations
      track_api_calls: true               # Track API endpoint coverage
      track_groups: true                  # Track TestNG groups
    
    
    # â”€â”€â”€ Selenium Python (Python UI Automation) ðŸ†• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    selenium_python:
      enabled: true
      
      # Automatic instrumentation
      auto_instrument_api_calls: false    # Focus on UI testing
      auto_instrument_ui_interactions: true  # Track WebDriver actions
      
      # Tracking options
      track_keywords: true                # Track pytest markers
      track_api_calls: false              # Not primary use case
      ast_extraction: true                # Full AST parsing enabled
    
    
    # â”€â”€â”€ Selenium Java (Java UI Automation) ðŸ†• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    selenium_java:
      enabled: true
      
      # Automatic instrumentation
      auto_instrument_api_calls: false    # Focus on UI testing
      auto_instrument_ui_interactions: true  # Track WebDriver actions
      
      # Tracking options
      track_keywords: true                # Track @Test annotations
      track_api_calls: false              # Not primary use case
      track_groups: true                  # Track TestNG groups
    
    
    # â”€â”€â”€ Cucumber (BDD Gherkin) ðŸ†• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    cucumber:
      enabled: true
      
      # Automatic instrumentation
      auto_instrument_api_calls: true     # Track API calls in steps
      auto_instrument_ui_interactions: true  # Track UI interactions in steps
      
      # Tracking options
      track_keywords: true                # Track Gherkin keywords
      track_api_calls: true               # Track API endpoint coverage
      parse_gherkin: true                 # Parse .feature files
      detect_step_patterns: true          # Detect API/UI patterns in steps
    
    
    # â”€â”€â”€ Behave (Python BDD) ðŸ†• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    behave:
      enabled: true
      
      # Automatic instrumentation
      auto_instrument_api_calls: true     # Track API calls in steps
      auto_instrument_ui_interactions: true  # Track UI interactions in steps
      
      # Tracking options
      track_keywords: true                # Track Gherkin keywords
      track_api_calls: true               # Track API endpoint coverage
      parse_gherkin: true                 # Parse .feature files
      detect_step_patterns: true          # Detect API/UI patterns in steps
    
    
    # â”€â”€â”€ Cypress (JavaScript E2E) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    cypress:
      enabled: true
      
      # Automatic instrumentation
      auto_instrument_api_calls: true     # Track cy.request() calls
      auto_instrument_ui_interactions: true  # Track cy.get(), cy.click(), etc.
      
      # Network monitoring
      capture_network_traffic: true       # Capture XHR/Fetch requests
      
      # Tracking options
      track_keywords: true                # Track custom commands
      track_api_calls: true               # Track API intercepts
  
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # LOGGING CONFIGURATION
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # Logging levels and output settings
  
  logging:
    # Global log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
    # DEBUG: Detailed diagnostic information (verbose)
    # INFO: General informational messages (default)
    # WARNING: Warning messages for potential issues
    # ERROR: Error messages for failures
    # CRITICAL: Critical errors requiring immediate attention
    level: INFO
    
    # Log format: simple, detailed, json
    # simple: Timestamp + level + message
    # detailed: Adds module, function, line number (default)
    # json: Machine-readable JSON format for log aggregation
    format: detailed
    
    # File logging
    log_to_file: true
    log_file_path: logs/crossbridge.log  # Relative or absolute path
    
    # Console logging (stdout)
    log_to_console: true
    
    # Log file rotation
    max_file_size_mb: 10    # Rotate after 10MB
    backup_count: 5         # Keep 5 backup files
    
    # Component-specific log levels (override global level)
    # Useful for debugging specific modules without flooding logs
    translation_level: null  # null = use global level
    ai_level: null           # Set to DEBUG for AI troubleshooting
    database_level: null     # Set to DEBUG for SQL query logging
    observer_level: null     # Set to DEBUG for observer diagnostics


# ============================================================================
# ENVIRONMENT-SPECIFIC OVERRIDES (Optional)
# ============================================================================
# You can maintain separate config files for different environments:
# - crossbridge.dev.yml
# - crossbridge.staging.yml
# - crossbridge.production.yml
# 
# Load with: export CROSSBRIDGE_CONFIG=crossbridge.staging.yml
# ============================================================================


  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # PERFORMANCE PROFILING (NEW)
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # Passive, framework-agnostic performance profiling for test execution
  # Disabled by default - explicitly enable when needed
  
  profiling:
    # Enable/disable performance profiling (DEFAULT: false)
    # Override with: CROSSBRIDGE_PROFILING=true/false
    enabled: false
    
    # Profiling mode: 'passive' (observer) or 'active' (future)
    mode: passive
    
    # Sampling rate: 1.0 = 100%, 0.5 = 50% of events
    sampling_rate: 1.0
    
    # â”€â”€ Collectors â”€â”€
    # Control which metrics are collected
    collectors:
      test_lifecycle: true      # Test start/end, setup/teardown timing
      webdriver: true           # Selenium WebDriver command timing
      http: true                # API/HTTP request timing
      system_metrics: false     # CPU/Memory usage (optional, can be expensive)
    
    # â”€â”€ Storage Backend â”€â”€
    # Options: 'none', 'local', 'postgres', 'influxdb'
    storage:
      backend: none  # DEFAULT: none (disabled)
      
      # Local file storage (JSONL format)
      local:
        path: .crossbridge/profiles
      
      # PostgreSQL storage (Grafana-friendly schema)
      postgres:
        host: ${CROSSBRIDGE_DB_HOST:-localhost}
        port: ${CROSSBRIDGE_DB_PORT:-5432}
        database: ${CROSSBRIDGE_DB_NAME:-crossbridge}
        user: ${CROSSBRIDGE_DB_USER:-crossbridge}
        password: ${CROSSBRIDGE_DB_PASSWORD:-crossbridge}
        schema: profiling  # Schema name for profiling tables
      
      # InfluxDB time-series storage (on-prem)
      influxdb:
        url: ${INFLUXDB_URL:-http://localhost:8086}
        org: ${INFLUXDB_ORG:-crossbridge}
        bucket: ${INFLUXDB_BUCKET:-profiling}
        token: ${INFLUX_TOKEN}
    
    # â”€â”€ Grafana Integration â”€â”€
    grafana:
      enabled: false
      datasource: postgres  # 'postgres' or 'influxdb'


# ============================================================================
# COMMON CONFIGURATION EXAMPLES
# ============================================================================

# Example 1: Local Development
# -----------------------------------------------------------------------------
# crossbridge:
#   mode: observer
#   database:
#     host: localhost
#     password: dev_password
#   ai:
#     enabled: false  # Save credits during development
#   flaky_detection:
#     min_executions_reliable: 5  # Lower threshold for faster feedback

# Example 2: CI/CD Pipeline
# -----------------------------------------------------------------------------
# crossbridge:
#   mode: observer
#   application:
#     application_version: ${CI_COMMIT_TAG}  # From GitLab CI
#     environment: ${CI_ENVIRONMENT_NAME}
#   translation:
#     mode: automated  # Faster for CI
#     validation_level: lenient
#   sidecar_hooks:
#     auto_integrate: true

# Example 3: Production Monitoring
# -----------------------------------------------------------------------------
# crossbridge:
#   mode: observer
#   application:
#     environment: production
#   observer:
#     flaky_threshold: 0.05  # Stricter in production
#   intelligence:
#     risk_based_recommendations: true
#   flaky_detection:
#     min_executions_confident: 50  # More data for confidence

# Example 4: Performance Profiling Enabled (PostgreSQL + Grafana)
# -----------------------------------------------------------------------------
# crossbridge:
#   profiling:
#     enabled: true
#     storage:
#       backend: postgres
#       postgres:
#         host: 10.60.67.247
#         port: 5432
#         database: cbridge-unit-test-db
#         user: postgres
#         password: admin
#     grafana:
#       enabled: true
#       datasource: postgres


# ============================================================================
# PRODUCTION RUNTIME CONFIGURATION
# ============================================================================
# Rate limiting, retry policies, and health checks for production robustness

runtime:
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # RATE LIMITING CONFIGURATION
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # Token bucket algorithm for fair per-user/org throttling
  
  rate_limiting:
    enabled: true
    
    # Default rate limits per operation type
    defaults:
      # Semantic search rate limits
      search:
        capacity: 30              # Tokens per window
        window_seconds: 60        # Refill window
      
      # Test transformation rate limits
      transform:
        capacity: 10
        window_seconds: 60
      
      # Embedding generation rate limits
      embed:
        capacity: 60
        window_seconds: 60
      
      # AI code generation rate limits
      ai_generate:
        capacity: 20
        window_seconds: 60
      
      # Health check rate limits
      health_check:
        capacity: 100
        window_seconds: 60
    
    # Cleanup settings
    cleanup_threshold: 1000       # Clean up buckets when count exceeds this
    
    # Per-user/org override examples (optional)
    # overrides:
    #   user:12345:
    #     search:
    #       capacity: 100
    #       window_seconds: 60
    #   org:premium:
    #     transform:
    #       capacity: 50
    #       window_seconds: 60
  
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # RETRY POLICY CONFIGURATION
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # Exponential backoff with jitter for transient failures
  
  retry:
    enabled: true
    
    # Default retry policy for most operations
    default_policy:
      max_attempts: 3             # Maximum retry attempts
      base_delay: 0.5             # Initial delay in seconds
      max_delay: 5.0              # Maximum delay cap
      exponential_base: 2.0       # Exponential multiplier (2^attempt)
      jitter: true                # Add randomness to prevent thundering herd
    
    # Expensive operations policy (AI, embeddings)
    expensive_policy:
      max_attempts: 5
      base_delay: 1.0
      max_delay: 10.0
      exponential_base: 2.0
      jitter: true
    
    # Quick retry policy (database, cache)
    quick_policy:
      max_attempts: 2
      base_delay: 0.1
      max_delay: 1.0
      exponential_base: 2.0
      jitter: true
    
    # Conservative retry policy (critical operations)
    conservative_policy:
      max_attempts: 3
      base_delay: 2.0
      max_delay: 30.0
      exponential_base: 3.0
      jitter: true
    
    # Retryable HTTP status codes
    retryable_codes:
      - 429  # Rate limit exceeded
      - 500  # Internal server error
      - 502  # Bad gateway
      - 503  # Service unavailable
      - 504  # Gateway timeout
    
    # Timeout for network operations (seconds)
    network_timeout: 30
  
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # HEALTH CHECK CONFIGURATION
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # Provider health monitoring for proactive failure detection
  
  health_checks:
    enabled: true
    
    # Global health check settings
    interval: 30                  # Check interval in seconds
    timeout: 10                   # Health check timeout
    failure_threshold: 3          # Failures before marking degraded
    
    # Providers to monitor
    providers:
      # AI provider health checks
      ai_provider:
        enabled: true
        check_type: embed         # Test method: embed, generate, ping
        interval: 60              # Override global interval
        timeout: 15               # Override global timeout
      
      # Embedding provider health checks
      embedding_provider:
        enabled: true
        check_type: embed
        interval: 60
        timeout: 10
      
      # Vector store health checks
      vector_store:
        enabled: true
        check_type: ping          # Methods: ping, health_check, get_collection
        interval: 30
        timeout: 5
      
      # Database health checks
      database:
        enabled: true
        check_type: ping
        interval: 20
        timeout: 5
      
      # Custom health checks
      # custom:
      #   enabled: true
      #   check_type: callable
      #   callable: my_module.health_check_function
      #   interval: 45
      #   timeout: 10
    
    # Degraded mode behavior
    degraded_mode:
      # Continue operating with limited functionality
      continue_on_degraded: true
      
      # Disable non-critical features when degraded
      disable_features:
        - flaky_detection
        - coverage_analysis
      
      # Alert configuration (optional)
      # alerts:
      #   slack_webhook: https://hooks.slack.com/...
      #   email: ops@example.com


  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # DEBUGGABLE SIDECAR RUNTIME (NEW)
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # Resilient, low-overhead sidecar observer for test execution monitoring
  # NEVER blocks or crashes the main process
  
  sidecar:
    # Enable/disable sidecar runtime (DEFAULT: true)
    enabled: true
    
    # â”€â”€ Sampling Configuration â”€â”€
    # Control what gets sampled and at what rate
    sampling:
      enabled: true
      
      # Global sampling rates (0.0 - 1.0)
      events: 0.1              # 10% of events
      traces: 0.05             # 5% of traces
      profiling: 0.01          # 1% profiling samples
      
      # Per-signal sampling rates
      test_events: 0.2         # 20% test events
      perf_metrics: 0.05       # 5% performance metrics
      debug_logs: 0.01         # 1% debug logs
      
      # Adaptive sampling (auto-boost on anomalies)
      adaptive:
        enabled: true
        boost_factor: 5.0      # 5x increase on anomaly
        boost_duration: 60     # Duration in seconds
    
    # â”€â”€ Resource Budgets â”€â”€
    # Hard limits to prevent sidecar from impacting main process
    resources:
      max_queue_size: 10000    # Maximum event queue size
      max_cpu_percent: 5.0     # Maximum CPU usage (%)
      max_memory_mb: 100       # Maximum memory usage (MB)
      drop_on_full: true       # Drop events when queue full
    
    # â”€â”€ Profiling Configuration â”€â”€
    profiling:
      enabled: true
      sampling_interval: 1.0   # Sample every N seconds
      
      # Deep profiling (DEBUG ONLY - higher overhead)
      deep_profiling: false
      deep_duration_sec: 30    # Auto-disable after N seconds
    
    # â”€â”€ Health Monitoring â”€â”€
    health_checks:
      enabled: true
      interval_sec: 30         # Check interval
      failure_threshold: 3     # Failures before marking unhealthy
    
    # â”€â”€ Metrics Export â”€â”€
    metrics:
      enabled: true
      prometheus_port: 9090    # Port for /metrics endpoint
      export_interval: 15      # Export interval in seconds


  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # AI TRANSFORMATION VALIDATION
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # Validate AI-generated code changes with confidence scoring and human review
  # Automatically enabled during migration mode with optimal defaults
  
  ai_transformation:
    # Enable/disable AI transformation validation (DEFAULT: auto-enabled in migration mode)
    enabled: ${AI_TRANSFORM_ENABLED:-auto}  # Options: true, false, auto
    
    # Storage configuration
    storage:
      # Directory for transformation JSON files
      directory: ${AI_TRANSFORM_STORAGE:-.crossbridge/transformations}
      
      # Backup before applying transformations
      backup_enabled: true
      backup_directory: .crossbridge/transformations/backups
    
    # â”€â”€ Confidence Scoring â”€â”€
    # Multi-signal confidence computation for AI-generated code
    confidence:
      # Minimum confidence threshold for auto-apply (0.0-1.0)
      # Transformations below this threshold REQUIRE human review
      threshold: ${AI_CONFIDENCE_THRESHOLD:-0.8}
      
      # Confidence level boundaries
      levels:
        high: 0.8      # >= 0.8 = HIGH confidence (optional review)
        medium: 0.5    # 0.5-0.79 = MEDIUM confidence (review required)
        # < 0.5 = LOW confidence (review required)
      
      # Signal weights for confidence computation
      signals:
        model_confidence:
          enabled: true
          weight: 1.0              # Base multiplier
        
        diff_size:
          enabled: true
          # Penalties based on lines changed
          small_threshold: 20      # <= 20 lines: no penalty
          medium_threshold: 50     # 21-50 lines: -0.1
          large_threshold: 100     # 51-100 lines: -0.2
          very_large_penalty: -0.3 # > 100 lines: -0.3
        
        rule_violations:
          enabled: true
          penalty_per_violation: -0.1
          max_penalty: -0.3
        
        similarity_to_existing:
          enabled: true
          low_threshold: 0.6       # < 0.6: -0.2 penalty
          medium_threshold: 0.8    # < 0.8: -0.1 penalty
        
        syntax_validation:
          enabled: true
          penalty: -0.4            # Invalid syntax penalty
        
        test_coverage:
          enabled: true
          penalty: -0.2            # Coverage loss penalty
    
    # â”€â”€ Review Workflow â”€â”€
    # Human review process for low-confidence transformations
    review:
      # Require reviewer email for approvals/rejections
      require_reviewer: true
      
      # Require comments when rejecting
      require_rejection_reason: true
      
      # Allow re-review after rejection
      allow_rereview: false
      
      # Auto-expire pending reviews after N days
      expire_pending_days: 30
    
    # â”€â”€ Apply & Rollback â”€â”€
    # Configuration for applying and reverting transformations
    apply:
      # Create git commit when applying (if in git repo)
      git_commit: ${AI_TRANSFORM_GIT_COMMIT:-true}
      git_commit_prefix: "AI Transform:"
      
      # Verify syntax before applying
      verify_syntax: true
      
      # Run linting before applying
      run_linting: false
      linting_command: "flake8"
      
      # Run tests before finalizing apply
      run_tests: false
      test_command: "pytest"
    
    rollback:
      # Maximum rollback history to keep
      max_history: 10
      
      # Require confirmation for rollback
      require_confirmation: true
      
      # Create git commit when rolling back
      git_commit: true
      git_commit_prefix: "Rollback AI Transform:"
    
    # â”€â”€ Audit & Compliance â”€â”€
    # Tracking and logging for compliance requirements
    audit:
      # Enable comprehensive audit trail
      enabled: true
      
      # Hash prompts for privacy (store hash, not full prompt)
      hash_prompts: true
      
      # Log all transformation events
      log_all_events: true
      
      # Export audit logs to separate file
      export_logs: true
      export_path: .crossbridge/transformations/audit.jsonl
    
    # â”€â”€ CLI Defaults â”€â”€
    # Default values for CLI commands
    cli:
      # Default output format (table, detailed, json)
      default_format: table
      
      # Show diffs by default in 'show' command
      show_diff_default: false
      
      # Auto-apply after approval by default
      auto_apply_default: false
    
    # â”€â”€ Migration Mode Auto-Configuration â”€â”€
    # When crossbridge.mode = 'migration', these settings override above
    migration_overrides:
      enabled: true                    # Always enable in migration mode
      confidence_threshold: 0.85       # Higher threshold for migrations
      review_require_reviewer: true    # Require reviewer
      apply_git_commit: true          # Always commit
      apply_verify_syntax: true       # Always verify
      audit_enabled: true             # Always audit


  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # API CHANGE INTELLIGENCE
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # Automatically enabled during migration for API test impact analysis
  
  api_change:
    enabled: false  # Set to true to enable API change intelligence
    
    # Spec source configuration
    spec_source:
      type: file  # Options: file, url, git
      current: specs/openapi.yaml
      previous: specs/openapi_prev.yaml
      
      # For URL-based specs:
      # type: url
      # current: https://api.example.com/v2/openapi.yaml
      # previous: https://api.example.com/v1/openapi.yaml
      # auth:
      #   type: bearer  # or 'basic'
      #   token: ${API_TOKEN}
      
      # For Git-based specs:
      # type: git
      # repository: https://github.com/example/api-specs.git
      # current_branch: main
      # previous_branch: release-1.0
      # spec_path: specs/openapi.yaml
    
    # Intelligence configuration
    intelligence:
      mode: hybrid  # Options: rules, hybrid, ai-only
      
      rules:
        enabled: true  # Rule-based intelligence (no AI required)
        
      ai:
        enabled: false  # Optional AI enhancement
        provider: openai  # Options: openai, anthropic
        model: gpt-4.1-mini  # or claude-3-5-sonnet-20240620
        api_key: ${OPENAI_API_KEY}  # Use environment variable
        max_tokens_per_month: 100000
        cost_limit_usd: 10.0
        max_retries: 3
        retry_backoff: 2
    
    # Impact analysis configuration
    impact_analysis:
      enabled: true
      test_directories:
        - tests/
        - test/
        - src/test/
      framework: pytest  # Options: pytest, robot, selenium, playwright, cypress, jest
      
      # Custom test-to-endpoint mappings
      custom_mappings:
        "GET /api/users":
          - test_file: tests/api/test_users.py
            test_name: test_get_users
        "POST /api/orders":
          - test_file: tests/api/test_orders.py
            test_name: test_create_order
      
      coverage_file: coverage/api-coverage.json
      min_confidence: 0.5
    
    # CI/CD integration
    ci_integration:
      enabled: true
      min_confidence: 0.5
      max_tests: 100
      frameworks:
        - pytest
        - robot
      exclude_patterns:
        - "**/integration/**"
        - "**/*slow*.py"
    
    # Alert configuration
    alerts:
      enabled: true
      
      # Email alerts
      email:
        enabled: false
        smtp_host: smtp.gmail.com
        smtp_port: 587
        smtp_user: alerts@example.com
        smtp_password: ${SMTP_PASSWORD}
        use_tls: true
        from_email: crossbridge@example.com
        to_emails:
          - qa-team@example.com
        subject_prefix: "[CrossBridge API Alert]"
        min_severity: high
        max_retries: 3
        retry_backoff: 2
      
      # Slack alerts
      slack:
        enabled: false
        webhook_url: ${SLACK_WEBHOOK_URL}
        channel: "#api-alerts"
        username: "CrossBridge AI"
        icon_emoji: ":robot_face:"
        mention_users:
          - U12345678
        min_severity: critical
        max_retries: 3
        retry_backoff: 2
      
      # Confluence alerts
      confluence:
        enabled: false
        url: https://your-domain.atlassian.net
        username: your-email@example.com
        auth_token: ${CONFLUENCE_TOKEN}
        space_key: API
        parent_page_id: 123456
        page_title_prefix: "API Change Alert"
        update_mode: create  # 'create' or 'update'
        max_retries: 3
        retry_backoff: 2
        min_severity: high
      
      # Microsoft Teams (planned)
      # teams:
      #   enabled: false
      #   webhook_url: ${TEAMS_WEBHOOK_URL}
    
    # Documentation generation
    documentation:
      enabled: true
      output_dir: docs/api-changes
      
      formats:
        markdown:
          enabled: true
          mode: incremental
          include_tests: true
          include_risk_badges: true
    
    # Grafana observability
    grafana:
      enabled: false
      dashboard_path: grafana/dashboards/api_change_intelligence.json
      datasource: postgresql
      refresh_interval: 30s

  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # SEMANTIC SEARCH & TEST INTELLIGENCE
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # Unified configuration for:
  # - Test normalization to UnifiedTestMemory format
  # - AST/structural signal extraction
  # - Vector embeddings and semantic similarity search
  # - Intelligent test discovery and recommendations
  semantic_search:
    # Enable/disable semantic search (auto = enable in migration mode)
    enabled: auto
    
    # â”€â”€ Test Normalization & AST Extraction â”€â”€
    # Automatic normalization to UnifiedTestMemory during test execution
    normalization:
      auto_normalize: true              # Auto-normalize tests to UnifiedTestMemory
      extract_structural_signals: true  # Extract imports, functions, assertions via AST
      extract_ui_interactions: true     # Extract UI commands (cy.click, page.goto, etc.)
      extract_api_calls: true           # Extract API endpoints and HTTP methods
      
      # Supported frameworks (all enabled by default)
      frameworks:
        cypress: true
        playwright: true
        robot: true
        pytest: true
        junit: true
        testng: true
        restassured: true
        selenium_java: true
        selenium_python: true
        cucumber: true
        behave: true
        specflow: true
    
    # â”€â”€ Embedding Provider Configuration â”€â”€
    # Embedding provider: openai, anthropic, local
    provider_type: openai
    
    # OpenAI configuration (text-embedding-3-large/small)
    openai:
      api_key: ${OPENAI_API_KEY}  # Required for OpenAI
      model: text-embedding-3-large  # 3072 dimensions, higher quality
      # model: text-embedding-3-small  # 1536 dimensions, faster/cheaper
      dimensions: 3072  # Match model dimensions
    
    # Anthropic configuration (Voyage AI)
    anthropic:
      api_key: ${ANTHROPIC_API_KEY}  # Required for Anthropic
      model: voyage-large-2  # 1536 dimensions
    
    # Local embedding configuration (sentence-transformers)
    local:
      model: all-MiniLM-L6-v2  # Fast, 384 dimensions
      device: cpu  # cpu or cuda
    
    # Search configuration
    search:
      max_tokens: 8000  # Maximum tokens for embedding text
      min_similarity_score: 0.7  # Minimum cosine similarity (0-1)
      default_top_k: 10  # Default number of results
      api_timeout: 30  # API timeout in seconds
      retry_attempts: 3  # Retry failed API calls
      batch_size: 100  # Batch size for bulk indexing
    
    # Vector store configuration
    vector_store:
      type: pgvector  # Currently only pgvector supported
      # Connection string from database.connection_string above
      index_type: ivfflat  # pgvector index type
      index_lists: 100  # Number of IVFFlat lists (tune based on data size)
      create_index_threshold: 1000  # Auto-create index after N entities
    
    # â”€â”€ Ingestion & Lifecycle â”€â”€
    ingestion:
      auto_ingest_on_discovery: true # Automatically ingest after test discovery
      update_on_change: true         # Re-embed when test code changes
      ttl_days: 90                   # Delete records older than N days (0 = never)
      cleanup_on_startup: false      # Clean old records on startup
    
    # â”€â”€ Migration Mode Overrides â”€â”€
    migration_overrides:
      enabled: true  # Always enable in migration mode
      provider_type: openai  # Preferred provider for migration
      model: text-embedding-3-large  # Best quality for migration analysis
      max_tokens: 8000
      min_similarity_score: 0.6  # Lower threshold for migration discovery
